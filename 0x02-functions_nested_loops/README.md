funtion and more nested loop
